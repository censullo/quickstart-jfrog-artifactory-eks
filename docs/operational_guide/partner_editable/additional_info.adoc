
== Update {partner-product-short-name}
// If Post-deployment steps are required, add them here. If not, remove the heading

To perform maintenance on the stack, update the CloudFormation stack rather than updating the infrastructure manually. This also applies to updating JFrog Artifactory. The JFrog Artifactory version for this Quick Start is 7.15.x, and the Xray version is 3.17.x. You can find current versions on the JFrog Artifactory *Service Status* page. For more information, see https://www.jfrog.com/confluence/display/JFROG/Monitoring+Service+Statuses[Monitoring Service Status].

NOTE: If you plan to upgrade both JFrog Artifactory and JFrog Xray, update JFrog Xray first.


== Updating Artifactory
// If Post-deployment steps are required, add them here. If not, remove the heading

If maintenance must be performed on the stack, ensure that you update the
CloudFormation stack rather than updating the infrastructure manually (this also applies to
updating Artifactory). The Artifactory version for this Quick Start is *7.0.x* (see <<update_1>>).


:xrefstyle: short
[#update_1]
.JFrog JFrog Artifactory service status page show current version
[link=../{quickstart-project-name}/images/update_1.png]
image::../images/update_1.png[image_placeholder,width=648,height=439]

. Choose the root stack, and then choose *Update* (see <<update_2>>).

:xrefstyle: short
[#update_2]
.Stack list and update button on the CloudFormation console
[link=../{quickstart-project-name}/images/update_2.png]
image::../images/update_2.png[image_placeholder,width=648,height=439]

[start=2]
. On the *Prerequisite* screen, Choose *Use current template*, and then choose *Next*
(see <<update_3>>).

:xrefstyle: short
[#update_3]
.Update stack, prerequisite information
[link=../{quickstart-project-name}/images/update_3.png]
image::../images/update_3.png[image_placeholder,width=648,height=439]

[start=3]
. Find the *Artifactory version* field by scrolling down (see <<update_4>>).

:xrefstyle: short
[#update_4]
.CloudFormation console update page (before you change the version)
[link=../{quickstart-project-name}/images/update_4.png]
image::../images/update_4.png[image_placeholder,width=648,height=439]

[start=4]
. Enter the version number that you want to run (see <<update_5>>).

:xrefstyle: short
[#update_5]
.CloudFormation console update page (after you change the version)
[link=../{quickstart-project-name}/images/update_5.png]
image::../images/update_5.png[image_placeholder,width=648,height=439]

[start=5]
. Scroll down, and choose *Next*. Choose *Next* again, unless you want to change any other tags or policies. Select the two *I acknowledge* check boxes, and choose *Update stack* (see <<update_6>>).

:xrefstyle: short
[#update_6]
.Completing the update process
[link=../{quickstart-project-name}/images/update_6.png]
image::../images/update_6.png[image_placeholder,width=648,height=439]

[start=6]
. When you choose *Update Stack*, Helm takes care of a rolling upgrade. If you want to 
watch the upgrade, log in to the bastion host and find the *BastionIP* in the *Outputs*
tab of the base Artifactory core stack. Connect from your local terminal to the bastion
host by using SSH, and run the following commands.

    # To list the deployment
    helm ls –-all
    # To see currently running pods. Add `watch` to view an update every
    2 seconds
    kubectl get pods -n jfrog-artifactory



== Security
// Provide post-deployment best practices for using the technology on AWS, including considerations such as migrating data, backups, ensuring high performance, high availability, etc. Link to software documentation for detailed information.

By default, the load balancer does not match your certificate. You must configure the DNS
according to your organization’s configuration, which is highly recommended for a
production deployment.

When you create a new VPC, the private subnet CIDR is automatically provided to the
database security group `ArtifactoryBDSG`. In the new VPC, the private subnet is accessible
only from the public subnet.

When you deploy to an existing VPC, ensure similar rules are followed so that your
Artifactory nodes are not accessible directly from the internet. Also, ensure that the private
CIDR is correct and locked down. Avoid using `0.0.0.0/0`. If the subnet is a public subnet, it
will allow your MySQL database to be available from the internet.

== Storage
//Provide any other information of interest to users, especially focusing on areas where AWS or cloud usage differs from on-premises usage.

A major difference between running on-premises and on AWS is storage. Because S3 is
used, you are charged for what is currently in use rather than what may be allocated onpremises. Ensure to https://www.jfrog.com/confluence/display/RTF/Monitoring+Storage[monitor your usage^].